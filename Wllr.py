import math,numpy
if __name__ == "__main__":
    with open('contengency_table1000.txt','r') as fptr:
        benign_wllr = []
        malware_wllr= []
        for i,line in enumerate(fptr):
            vc = line.replace('\n','').replace('[','').replace(']','').replace(', ',':').split(' ')
            term=vc[0]
            data = vc[1].split(':')
            if i == 0:
                pass
            else:
                Ai_benign = int(data[0])
                Ai_malware = int(data[2])
                Bi_benign = int(data[2])
                Bi_malware = int(data[0])
                Ni_benign = int(data[0])+int(data[1])
                Ni_malware = int(data[2])+int(data[3])
                Ni_all= Ni_benign+Ni_malware
                if (Bi_malware == 0 or Ai_malware == 0):
                    malware_i_wllr = 0
                else:
                    malware_i_wllr = (Ai_malware / Ni_malware)
                    temp1 = Ai_malware * (Ni_all - Ni_malware)
                    temp1 = temp1 / (Bi_malware * Ni_malware)
                    temp1 = math.log(temp1, 2)
                    malware_i_wllr = malware_i_wllr * temp1
                malware_wllr.append((vc[0], malware_i_wllr))
                print(i, "  ", vc[0], " ", malware_i_wllr)
                if(Bi_benign==0 or Ai_benign==0):
                    benign_i_wllr=0
                else:
                    benign_i_wllr = (Ai_benign/Ni_benign)
                    temp = Ai_benign*(Ni_all-Ni_benign)
                    temp = temp/(Bi_benign*Ni_benign)
                    temp = math.log(temp,2)
                    benign_i_wllr=benign_i_wllr*temp
                benign_wllr.append((vc[0],benign_i_wllr))
                print(i,"  ",vc[0]," ",benign_i_wllr)


        benign_wllr.sort(key=lambda tup: tup[1], reverse=True)
        malware_wllr.sort(key=lambda tup: tup[1], reverse=True)
        with open('benign_sorted_output1.txt','w+') as op:
            for feature,benign_i_wllr in benign_wllr:
                op.write(feature+' '+str(benign_i_wllr)+'\n')
        with open('malware_sorted_output1.txt','w+') as op:
            for feature,malware_i_wllr in malware_wllr:
                op.write(feature+' '+str(malware_i_wllr)+'\n')

        
            
             
                 
             
            
